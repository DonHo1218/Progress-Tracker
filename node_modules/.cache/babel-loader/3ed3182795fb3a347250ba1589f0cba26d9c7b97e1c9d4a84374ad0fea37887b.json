{"ast":null,"code":"import{useState,useEffect}from'react';import{format,addDays}from'date-fns';import{getDatabase,ref,set,onValue}from\"firebase/database\";import{initializeApp}from\"firebase/app\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const firebaseConfig={apiKey:\"AIzaSyCiUYxb2931zDsYW57ujaoQ_2SUoFoZSn8\",authDomain:\"project-progress-a5543.firebaseapp.com\",projectId:\"project-progress-a5543\",storageBucket:\"project-progress-a5543.firebasestorage.app\",messagingSenderId:\"946944548390\",appId:\"1:946944548390:web:c250d15f965decace250e7\",measurementId:\"G-J5NGPSG13G\"};const app=initializeApp(firebaseConfig);const db=getDatabase(app);export default function ProgressTracker(){const[units,setUnits]=useState([]);useEffect(()=>{const unitsRef=ref(db,'units');onValue(unitsRef,snapshot=>{const data=snapshot.val();if(data){setUnits(Object.values(data));}});},[]);const handleCheckboxChange=(index,task)=>{const updatedUnits=[...units];updatedUnits[index].tasks[task]=!updatedUnits[index].tasks[task];const allDone=Object.values(updatedUnits[index].tasks).every(v=>v);updatedUnits[index].show=!allDone;setUnits(updatedUnits);saveToFirebase(updatedUnits);};const saveToFirebase=data=>{const unitsRef=ref(db,'units');const updateObj={};data.forEach((u,i)=>{updateObj[i]=u;});set(unitsRef,updateObj);};return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 space-y-4\",children:units.map((unit,index)=>unit.show&&/*#__PURE__*/_jsxs(\"div\",{style:{border:'1px solid #ddd',padding:'1rem',marginBottom:'1rem'},children:[/*#__PURE__*/_jsx(\"input\",{defaultValue:unit.name,onChange:e=>{const updated=[...units];updated[index].name=e.target.value;setUnits(updated);saveToFirebase(updated);},style:{fontWeight:'bold',width:'30%'}}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'2rem',marginTop:'0.5rem'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"IN \\u65E5\\u671F\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:format(new Date(unit.inDate),'yyyy-MM-dd'),onChange:e=>{const date=new Date(e.target.value);const updated=[...units];updated[index].inDate=date;updated[index].deadline=addDays(date,90);setUnits(updated);saveToFirebase(updated);}})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"DEADLINE\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{value:format(new Date(unit.deadline),'yyyy-MM-dd'),readOnly:true})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(4, 1fr)',gap:'1rem',marginTop:'1rem'},children:Object.keys(unit.tasks).map((taskKey,tIndex)=>/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:unit.tasks[taskKey],onChange:()=>handleCheckboxChange(index,taskKey)}),taskKey]},tIndex))}),/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"\\u5099\\u8A3B...\",value:unit.remark,onChange:e=>{const updated=[...units];updated[index].remark=e.target.value;setUnits(updated);saveToFirebase(updated);},style:{width:'100%',minHeight:'80px',marginTop:'1rem'}})]},index))});}","map":{"version":3,"names":["useState","useEffect","format","addDays","getDatabase","ref","set","onValue","initializeApp","jsx","_jsx","jsxs","_jsxs","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","app","db","ProgressTracker","units","setUnits","unitsRef","snapshot","data","val","Object","values","handleCheckboxChange","index","task","updatedUnits","tasks","allDone","every","v","show","saveToFirebase","updateObj","forEach","u","i","className","children","map","unit","style","border","padding","marginBottom","defaultValue","name","onChange","e","updated","target","value","fontWeight","width","display","gap","marginTop","type","Date","inDate","date","deadline","readOnly","gridTemplateColumns","keys","taskKey","tIndex","checked","placeholder","remark","minHeight"],"sources":["D:/progress-tracker/src/App.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { format, addDays } from 'date-fns';\nimport { getDatabase, ref, set, onValue } from \"firebase/database\";\nimport { initializeApp } from \"firebase/app\";\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyCiUYxb2931zDsYW57ujaoQ_2SUoFoZSn8\",\n  authDomain: \"project-progress-a5543.firebaseapp.com\",\n  projectId: \"project-progress-a5543\",\n  storageBucket: \"project-progress-a5543.firebasestorage.app\",\n  messagingSenderId: \"946944548390\",\n  appId: \"1:946944548390:web:c250d15f965decace250e7\",\n  measurementId: \"G-J5NGPSG13G\"\n};\n\nconst app = initializeApp(firebaseConfig);\nconst db = getDatabase(app);\n\nexport default function ProgressTracker() {\n  const [units, setUnits] = useState([]);\n\n  useEffect(() => {\n    const unitsRef = ref(db, 'units');\n    onValue(unitsRef, (snapshot) => {\n      const data = snapshot.val();\n      if (data) {\n        setUnits(Object.values(data));\n      }\n    });\n  }, []);\n\n  const handleCheckboxChange = (index, task) => {\n    const updatedUnits = [...units];\n    updatedUnits[index].tasks[task] = !updatedUnits[index].tasks[task];\n    const allDone = Object.values(updatedUnits[index].tasks).every(v => v);\n    updatedUnits[index].show = !allDone;\n    setUnits(updatedUnits);\n    saveToFirebase(updatedUnits);\n  };\n\n  const saveToFirebase = (data) => {\n    const unitsRef = ref(db, 'units');\n    const updateObj = {};\n    data.forEach((u, i) => {\n      updateObj[i] = u;\n    });\n    set(unitsRef, updateObj);\n  };\n\n  return (\n    <div className=\"p-4 space-y-4\">\n      {units.map((unit, index) => (\n        unit.show && (\n          <div key={index} style={{ border: '1px solid #ddd', padding: '1rem', marginBottom: '1rem' }}>\n            <input\n              defaultValue={unit.name}\n              onChange={(e) => {\n                const updated = [...units];\n                updated[index].name = e.target.value;\n                setUnits(updated);\n                saveToFirebase(updated);\n              }}\n              style={{ fontWeight: 'bold', width: '30%' }}\n            />\n            <div style={{ display: 'flex', gap: '2rem', marginTop: '0.5rem' }}>\n              <div>\n                <label>IN 日期</label><br />\n                <input\n                  type=\"date\"\n                  value={format(new Date(unit.inDate), 'yyyy-MM-dd')}\n                  onChange={(e) => {\n                    const date = new Date(e.target.value);\n                    const updated = [...units];\n                    updated[index].inDate = date;\n                    updated[index].deadline = addDays(date, 90);\n                    setUnits(updated);\n                    saveToFirebase(updated);\n                  }}\n                />\n              </div>\n              <div>\n                <label>DEADLINE</label><br />\n                <input value={format(new Date(unit.deadline), 'yyyy-MM-dd')} readOnly />\n              </div>\n            </div>\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '1rem', marginTop: '1rem' }}>\n              {Object.keys(unit.tasks).map((taskKey, tIndex) => (\n                <label key={tIndex}>\n                  <input\n                    type=\"checkbox\"\n                    checked={unit.tasks[taskKey]}\n                    onChange={() => handleCheckboxChange(index, taskKey)}\n                  />\n                  {taskKey}\n                </label>\n              ))}\n            </div>\n            <textarea\n              placeholder=\"備註...\"\n              value={unit.remark}\n              onChange={(e) => {\n                const updated = [...units];\n                updated[index].remark = e.target.value;\n                setUnits(updated);\n                saveToFirebase(updated);\n              }}\n              style={{ width: '100%', minHeight: '80px', marginTop: '1rem' }}\n            />\n          </div>\n        )\n      ))}\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}